\documentclass[slovene,11pt,a4paper]{article}
\usepackage[margin=2cm,bottom=3cm,foot=1.5cm]{geometry}
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.5ex}

\usepackage[pdftex]{graphicx}
\DeclareGraphicsExtensions{.pdf,.png}


\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage[usenames]{color}
\usepackage[slovene]{babel}
\usepackage[utf8]{inputenc}
\usepackage{siunitx}

\def\phi{\varphi}
\def\eps{\varepsilon}
\def\theta{\vartheta}

\newcommand{\thisyear}{2025/26}

\renewcommand{\Re}{\mathop{\rm Re}\nolimits}
\renewcommand{\Im}{\mathop{\rm Im}\nolimits}
\newcommand{\Tr}{\mathop{\rm Tr}\nolimits}
\newcommand{\diag}{\mathop{\rm diag}\nolimits}
\newcommand{\dd}{\,\mathrm{d}}
\newcommand{\ddd}{\mathrm{d}}
\newcommand{\ii}{\mathrm{i}}
\newcommand{\lag}{\mathcal{L}\!}
\newcommand{\ham}{\mathcal{H}\!}
\newcommand{\four}[1]{\mathcal{F}\!\left(#1\right)}
\newcommand{\bigO}[1]{\mathcal{O}\!\left(#1\right)}
\newcommand{\sh}{\mathop{\rm sinh}\nolimits}
\newcommand{\ch}{\mathop{\rm cosh}\nolimits}
\renewcommand{\th}{\mathop{\rm tanh}\nolimits}
\newcommand{\erf}{\mathop{\rm erf}\nolimits}
\newcommand{\erfc}{\mathop{\rm erfc}\nolimits}
\newcommand{\sinc}{\mathop{\rm sinc}\nolimits}
\newcommand{\rect}{\mathop{\rm rect}\nolimits}
\newcommand{\ee}[1]{\cdot 10^{#1}}
\newcommand{\inv}[1]{\left(#1\right)^{-1}}
\newcommand{\invf}[1]{\frac{1}{#1}}
\newcommand{\sqr}[1]{\left(#1\right)^2}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\thalf}{\tfrac{1}{2}}
\newcommand{\pd}{\partial}
\newcommand{\Dd}[3][{}]{\frac{\ddd^{#1} #2}{\ddd #3^{#1}}}
\newcommand{\Pd}[3][{}]{\frac{\pd^{#1} #2}{\pd #3^{#1}}}
\newcommand{\avg}[1]{\left\langle#1\right\rangle}
\newcommand{\norm}[1]{\left\Vert #1 \right\Vert}
\newcommand{\braket}[2]{\left\langle #1 \vert#2 \right\rangle}
\newcommand{\obraket}[3]{\left\langle #1 \vert #2 \vert #3 \right \rangle}
\newcommand{\hex}[1]{\texttt{0x#1}}

\renewcommand{\iint}{\mathop{\int\mkern-13mu\int}}
\renewcommand{\iiint}{\mathop{\int\mkern-13mu\int\mkern-13mu\int}}
\newcommand{\oiint}{\mathop{{\int\mkern-15mu\int}\mkern-21mu\raisebox{0.3ex}{$\bigcirc$}}}

\newcommand{\wunderbrace}[2]{\vphantom{#1}\smash{\underbrace{#1}_{#2}}}

\renewcommand{\vec}[1]{\overset{\smash{\hbox{\raise -0.42ex\hbox{$\scriptscriptstyle\rightharpoonup$}}}}{#1}}
\newcommand{\bec}[1]{\mathbf{#1}}

\title{
\sc\large Matematično-fizikalni praktikum \thisyear \\
\bigskip
\bf\Large 4.~naloga: Fourierova analiza
}
\author{Samo Krejan, 28231092}
\date{}

\begin{document}
\maketitle
% \vspace{-1cm}


Pri numeričnem izračunavanju Fourierove transformacije
\begin{equation}
H(f) = \int_{-\infty}^\infty
h(t)\exp(2 \pi \ii f t)\dd t
\label{eq:ft}
\end{equation}
\begin{equation}
h(t) = \int_{-\infty}^\infty
H(f)\exp(-2 \pi \ii f t)\dd f
\end{equation}
je funkcija $h(t)$ običajno predstavljena s tablico diskretnih
vrednosti
\begin{equation}
  h_k = h(t_k),\quad t_k = k \Delta, \quad k=0,1,2,\dots N-1.
  \label{eq:discrete}
\end{equation}
Pravimo, da smo funkcijo vzorčili z vzorčno gostoto (frekvenco) $f=1/\Delta$.
Za tako definiran vzorec obstaja naravna meja frekvenčnega spektra,
ki se imenuje {\sl Nyquistova frekvenca}, $f_c =1/(2\Delta)$:
harmonični val s to frekvenco ima v vzorčni gostoti ravno
dva vzorca v periodi.
če ima funkcija $h(t)$ frekvenčni spekter omejen na interval
$[-f_c, f_c ]$, potem ji z vzorčenjem nismo odvzeli nič informacije,
kadar pa se spekter razteza izven intervala, pride do {\sl potujitve\/}
({\sl aliasing\/}), ko se zunanji del spektra preslika v interval.

Frekvenčni spekter vzorčene funkcije (\ref{eq:discrete}) računamo samo
v $N$ točkah, če hočemo, da se ohrani količina informacije.
Vpeljemo vsoto
\begin{equation}
H_n = \sum_{k=0}^{N-1}
h_k \exp(2 \pi \ii k n / N),
\qquad n=-\tfrac{N}{2},\dots ,\tfrac{N}{2},
\label{eq:dft}
\end{equation}
ki jo imenujemo diskretna Fourierova transformacija
in je povezana s funkcijo v (\ref{eq:ft}) takole:
\begin{equation*}
H(\tfrac{n}{N\Delta}) \approx \Delta\cdot H_n .
\end{equation*}
Zaradi potujitve, po kateri je $H_{-n} = H_{N-n}$, lahko pustimo
indeks $n$ v enačbi (\ref{eq:dft}) teči tudi od 0 do $N$. Spodnja polovica
tako definiranega spektra ($1 \le n \le \tfrac{N}{2}-1$) ustreza pozitivnim
frekvencam $0 < f < f_c$, gornja polovica ($\tfrac{N}{2}+1 \le N-1$)
pa negativnim, $-f_c < f < 0$.  Posebna vrednost pri $n=0$
ustreza frekvenci nič (``istosmerna komponenta''), vrednost
pri $n=N/2$ pa ustreza tako $f_c$ kot $-f_c$.

Količine $h$ in $H$ so v splošnem kompleksne, simetrija
v enih povzroči tudi simetrijo v drugih.  Posebej zanimivi
so trije primeri:\par\medskip
\begin{tabular}{@{\hspace{1cm}}l@{\hspace{1cm}}l@{\hspace{1cm}}l@{\hspace{1cm}}l}
če je& $h_k$ realna & tedaj je & $H_{N-n} = H_n^\ast$ \\
      & $h_k$ realna in soda & & $H_n$ realna in soda \\
      & $h_k$ realna in liha & & $H_n$ imaginarna in liha
\end{tabular}
\par\medskip
(ostalih ni težko izpeljati).
V tesni zvezi s frekvenčnim spektrom je tudi moč.
{\sl Celotna moč\/} nekega signala je neodvisna od
reprezentacije, Parsevalova enačba pove
\begin{equation*}
\sum_{k=0}^{N-1} | h_k |^2 = {1\over N}\sum_{n=0}^{N-1} | H_n |^2
\end{equation*}
(lahko preveriš).  Pogosto pa nas bolj zanima, koliko moči
je vsebovane v frekvenčni komponenti med $f$ in $f+\dd f$, zato
definiramo enostransko spektralno gostoto moči ({\sl one-sided
power spectral density\/}, PSD)
\begin{equation*}
P_n = | H_n |^2 + | H_{N-n} |^2 \>.
\end{equation*}
Pozor: s takšno definicijo v isti koš mečemo negativne
in pozitivne frekvence, vendar sta pri realnih signalih $h_k$
prispevka enaka, tako da je $P_n = 2\,| H_n |^2$.

Z obratno transformacijo lahko tudi rekonstruiramo $h_k$ iz $H_n$
\begin{equation}
  h_k = {1\over N} \sum_{n=0}^{N-1} H_n \exp(-2 \pi \ii k n / N)
  \label{eq:inverz}
\end{equation}
(razlika glede na enačbo (\ref{eq:dft}) je le predznak v argumentu
eksponenta in utež $1/N$).

\bigskip

% {\it Naloga\/}:
\section{Naloga}

\begin{enumerate}
\item Izračunaj Fourierov obrat Gaussove porazdelitve in nekaj enostavnih vzorcev,
npr. mešanic izbranih frekvenc. Za slednje primerjaj rezultate, ko
je vzorec v intervalu periodičen (izbrane frekvence so mnogokratniki
osnovne frekvence), z rezultati, ko vzorec ni periodičen (kako naredimo Gaussovo porazdelitev `periodično' za FT?).
Opazuj pojav potujitve na vzorcu, ki vsebuje frekvence nad Nyquistovo
frekvenco. Napravi še obratno transformacijo (\ref{eq:inverz}) in preveri
natančnost metode. Poglej, kaj se dogaja z časom računanja - kako je odvisen od števila vzorčenj?
\item Po Fourieru analiziraj \SI{2.3}{s} dolge zapise začetka Bachove
partite za violino solo, ki jih najdeš na spletni strani
Matematičnofizikalnega praktikuma.  Signal iz začetnih taktov
partite je bil vzorčen pri \SI{44100}{Hz}, \SI{11025}{Hz}, \SI{5512}{Hz}, \SI{2756}{Hz},
\SI{1378}{Hz} in \SI{882}{Hz}.  S poslušanjem zapisov v formatu {\tt .mp3}
ugotovi, kaj se dogaja, ko se znižuje frekvenca vzorčenja,
nato pa s Fourierovo analizo zapisov v formatu {\tt .txt}
to tudi prikaži.
\end{enumerate}


\subsection{Osnovni primeri}

Zaradi časovne zahtevnosti Fourierove transformacije sem se odločil za implementacijo DFT algoritma v RUST programskem jeziku. Metodo sem nato najprej preveril na nekaterih osnovnih primerih, kjer iz teorije vem kaj pričakovati. To sta bila v prvi vrsti čisti realni sinusni in kosinusni signal, kjer sem med drugim namenil veliko pozornosti temu, da sem poskrbel, da je signal vzorčen periodično: torej, če bi kopijo signala "prilepil" na njegovo levo ali desno stran ne bi bilo opaziti nobenih skokov. Za to sem poskrbel tako da sem $numpy$ funkciji linspace dodal parameter $endpoint=False$. Na ta način sem dobil grafe (\ref{fig: basic1}, \ref{fig: basic2})

Na slik \ref{fig: basic1} vidimo že vse lastnosti Fourierjevega obrata, ki so opisane v uvodu. Ker je kosinusni signal realen in sod je tak tudi Fourierev obrat in ker je sinusni signal realen in lih, je njegov Fourierev obrat imaginaren in lih. 

Slika \ref{fig: basic2} je super ponazoritev uporabnosti Fourierjevega obrata, saj smo z njim uspeli nek \textit{čuden} signal dekonstruirati nazaj v njegove harmonične komponente
\newpage

\begin{figure}[h]
    \centering
    \begin{minipage}{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphs/sin.pdf}
        % \caption{Caption for image 1}
        % \label{fig:image1}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphs/cos.pdf}
        % \caption{Caption for image 2}
        % \label{fig:image2}
    \end{minipage}
    \caption{Fourierev obrat $H_k$ sinusnega signala $h_k$ (levo) in cosinusnega signala $h_k$ (desno)}
    \label{fig: basic1}
\end{figure}

\begin{figure}[ht]
\begin{center}
  \includegraphics[width=8cm]{graphs/combo.pdf}
  \caption{Fourierev obrat $H_k$ kombinacije sinusnega in kosinusnega signala $h_k$ z različnima frekvencama}
  \label{fig: basic2}
\end{center}
\end{figure}


% \newpage
Naslednji pomemben osnoven primer, ki sem si ga pogledal je DFT Gaussove funkcije. Ta je nekoliko specifičen, saj če ga želimo narediti periodičnega v smislu da je prva točka vzorčenja tista, ki ustreza vrednosti $x=0$, moramo vzorčenje pravzaprav presekati na polovici in nato desno polovico premakniti na levo stran, levo pa na desno. Temu je tako, saj DFT predvideva, da se naše vzorčenje vendo začne v izhodišču. Razlika med upoštevanjem tega detajla in ne je prikazana na sliki \ref{fig: gauss}

\newpage
\begin{figure}[ht]
    \centering
    \begin{minipage}{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphs/gauss_non_periodic.pdf}
        % \caption{Caption for image 1}
        % \label{fig:image1}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphs/gauss_periodic.pdf}
        % \caption{Caption for image 2}
        % \label{fig:image2}
    \end{minipage}
    \caption{Fourierev obrat $H_k$ Gaussove funkcije $h_k$ ki je periodična (desno) in ne-periodična (levo)}
    \label{fig: gauss}
\end{figure}
Vidimo, da na levem delu slike \ref{fig: gauss} pri Fourierevem obratu pride do nekih "dodatnih sinusov" kar se da teoretično razložiti kot Fourierjev obrat Gaussove funkcije prestavljene v desno, na desni pa vidimo (kot je pričakovati), da je obrat Gaussove funkcije Gaussova funkcija.

\subsection{Problem neperiodičnosti}

V prejšnjem poglavju sem omenil, da sem namenil kar nekaj pozornosti namenil ohranjanju periodičnosti signala (tako, da sem uporabil zastavico $endpoint=False$ pri numpy linspace). A kaj bi se zgodilo, če na to ne bi bil pozoren? Izkaže se, da pride do pojava \textit{puščanja} (ang: leakage). Zaradi le tega višine vrhov niso več sorazmerne z jakostjo signala in sam signal ni več omejen na eno samo frekvenco. Vizualno se to lepo vidi na skili \ref{fig: puscanje}, kjer je signalu iz slike \ref{fig: basic2} dodana zgolj ena točka, ki uniči periodičnost a zaradi nje že vidimo puščanje.

% \newpage
\begin{figure}[ht]
    \centering
    \begin{minipage}{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphs/combo.pdf}
        % \caption{Caption for image 1}
        % \label{fig:image1}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphs/non_periodic.pdf}
        % \caption{Caption for image 2}
        % \label{fig:image2}
    \end{minipage}
    \caption{Fourierev obrat $H_k$ kombiniranega signala (glej sliko \ref{fig: basic2}) $h_k$ ki je periodična (desno) in ne-periodična (levo)}
    \label{fig: puscanje}
\end{figure}

Vidimo, da na srečo težava s periodičnostjo ne vpliva na $\vert H_k\vert^2$, tako kot smo to lahko opazili že pri Gaussovi funkciji na sliki \ref{fig: gauss}

\subsection{Potujitev}

Do naslednjega izziva sem prišel, ko sem poskusil narediti Fourierev obrat za harmonične signale s frekvenco 


\end{document}