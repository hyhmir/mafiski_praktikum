\documentclass[slovene,11pt,a4paper]{article}
\usepackage[margin=2cm,bottom=3cm,foot=1.5cm]{geometry}
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.5ex}

\usepackage[pdftex]{graphicx}
\DeclareGraphicsExtensions{.pdf,.png}


\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage[usenames]{color}
\usepackage[slovene]{babel}
\usepackage[utf8]{inputenc}
\usepackage{siunitx}
\usepackage{hyperref}
\usepackage{float}

% \def\phi{\varphi}
\def\eps{\varepsilon}
\def\theta{\vartheta}

\newcommand{\thisyear}{2025/26}

\renewcommand{\Re}{\mathop{\rm Re}\nolimits}
\renewcommand{\Im}{\mathop{\rm Im}\nolimits}
\newcommand{\Tr}{\mathop{\rm Tr}\nolimits}
\newcommand{\diag}{\mathop{\rm diag}\nolimits}
\newcommand{\dd}{\,\mathrm{d}}
\newcommand{\ddd}{\mathrm{d}}
\newcommand{\ii}{\mathrm{i}}
\newcommand{\lag}{\mathcal{L}\!}
\newcommand{\ham}{\mathcal{H}\!}
\newcommand{\four}[1]{\mathcal{F}\!\left(#1\right)}
\newcommand{\bigO}[1]{\mathcal{O}\!\left(#1\right)}
\newcommand{\sh}{\mathop{\rm sinh}\nolimits}
\newcommand{\ch}{\mathop{\rm cosh}\nolimits}
\renewcommand{\th}{\mathop{\rm tanh}\nolimits}
\newcommand{\erf}{\mathop{\rm erf}\nolimits}
\newcommand{\erfc}{\mathop{\rm erfc}\nolimits}
\newcommand{\sinc}{\mathop{\rm sinc}\nolimits}
\newcommand{\rect}{\mathop{\rm rect}\nolimits}
\newcommand{\ee}[1]{\cdot 10^{#1}}
\newcommand{\inv}[1]{\left(#1\right)^{-1}}
\newcommand{\invf}[1]{\frac{1}{#1}}
\newcommand{\sqr}[1]{\left(#1\right)^2}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\thalf}{\tfrac{1}{2}}
\newcommand{\pd}{\partial}
\newcommand{\Dd}[3][{}]{\frac{\ddd^{#1} #2}{\ddd #3^{#1}}}
\newcommand{\Pd}[3][{}]{\frac{\pd^{#1} #2}{\pd #3^{#1}}}
\newcommand{\avg}[1]{\left\langle#1\right\rangle}
\newcommand{\norm}[1]{\left\Vert #1 \right\Vert}
\newcommand{\braket}[2]{\left\langle #1 \vert#2 \right\rangle}
\newcommand{\obraket}[3]{\left\langle #1 \vert #2 \vert #3 \right \rangle}
\newcommand{\hex}[1]{\texttt{0x#1}}

\renewcommand{\iint}{\mathop{\int\mkern-13mu\int}}
\renewcommand{\iiint}{\mathop{\int\mkern-13mu\int\mkern-13mu\int}}
\newcommand{\oiint}{\mathop{{\int\mkern-15mu\int}\mkern-21mu\raisebox{0.3ex}{$\bigcirc$}}}

\newcommand{\wunderbrace}[2]{\vphantom{#1}\smash{\underbrace{#1}_{#2}}}

\renewcommand{\vec}[1]{\overset{\smash{\hbox{\raise -0.42ex\hbox{$\scriptscriptstyle\rightharpoonup$}}}}{#1}}
\newcommand{\bec}[1]{\mathbf{#1}}

\title{
\sc\large Matematično-fizikalni praktikum \thisyear \\
\bigskip
\bf\Large 8.~naloga: Robni problem lastnih vrednosti
}
\author{Samo Krejan, 28231092}
\date{}

\begin{document}
\maketitle

Pri robnem problemu lastnih vrednosti poznamo diferencialno enačbo
in nekaj robnih pogojev (običajno vsaj toliko, kolikor je red enačbe)
Za rešitev problema moramo v splošnem v enem zamahu določiti
tako (lastne) funkcije, ki ustrezajo danim robnim pogojem,
kot (lastne) vrednosti, ki skupaj zadoščajo diferencialni enačbi.
Reševanje robnih problemov je zato lahko bistveno bolj zapleteno
kot integracija začetnih problemov.


Numerično bomo reševali stacionarno Schr\"odingerjevo enačbo
\begin{equation*}
-\frac{\hbar^2}{2m}\,\Dd[2]{\psi}{x} + V(x)\psi = E\psi  
\end{equation*}
za neskončno potencialno jamo ($V(-a/2 < x < a/2)=0$ 
in $V(|x|\ge a/2)\to\infty$) ter za končno potencialno jamo
($V(|x|\ge a/2)=V_0$), za kateri poznamo analitične rešitve;
glej Strnad, {\sl Fizika II\/}.  Dva značilna pristopa, diferenčna
metoda in strelska metoda, nas bosta pripravila na resnejše probleme,
za katere analitičnih rešitev ne poznamo.

Pri {\sl diferenčni metodi\/} razdelimo interval
$[-a/2,a/2]$ na $N$ točk ($x_i = -a/2 + ia/N$) in prepišemo drugi
krajevni odvod v drugo diferenco, tako da ima brezdimenzijska enačba obliko
\begin{equation*}
\frac{\psi_{i-1} - 2\psi_i + \psi_{i+1}}{h^2} + E\psi_i = 0  
\end{equation*}
oziroma
\begin{equation*}
\psi_{i-1} - (2-\lambda)\psi_i + \psi_{i+1} = 0 \>,  
\end{equation*}
kjer je $\lambda=Eh^2=k^2h^2$.  Diskretizirati je treba tudi robna
pogoja pri $x=-a/2$ in $x=a/2$, ki sta v splošnem (in tudi
pri končni jami) mešanega tipa,
\begin{align*}
c_1 \psi_0 + c_2 \frac{\psi_1 - \psi_{-1}}{2h} =& 0 \>, \\
d_1 \psi_N + d_2 \frac{\psi_{N+1} - \psi_{N-1}}{2h} =& 0 \>,
\end{align*}
medtem ko sta pri neskončni jami preprostejša, $\psi_0=\psi_N=0$.
V primerih potencialnih jam tako dobimo tridiagonalni sistem $N$
oziroma $N-1$ linearnih enačb
\begin{equation*}
A \underline{\psi} = \lambda \underline{\psi}   
\end{equation*}
za lastne vektorje $\underline{\psi}$ in lastne vrednosti $\lambda$,
ki ga rešujemo z diagonalizacijo.  

\smallskip

Pri {\sl strelski metodi\/} začnemo s ``kosinusnim'' začetnim pogojem
v izhodišču $\psi(0)=1$, $\psi'(0)=0$ ali ``sinusnim'' pogojem
$\psi(0)=0$, $\psi'(0)=1$, nato pa z nekim izbranim $E$ diferencialno
enačbo s poljubno integracijsko shemo (npr.~RK4) integriramo do roba
$x=a/2$ in tam preverimo, ali je izpolnjen drugi robni pogoj, $\psi(a/2)=0$.
Vrednost $E$ spreminjamo tako dolgo, dokler robni pogoj ni izpolnjen do
zahtevane natančnosti, in tako dobimo sode in lihe rešitve enačbe
skupaj z ustreznimi lastnimi vrednostmi energije.


\section{Naloga}

Določi nekaj najnižjih lastnih funkcij in lastnih
vrednosti za
neskončno in končno potencialno jamo z diferenčno metodo in metodo streljanja, lahko pa poskusiš še iterativno in  s kakšno drugo metodo. 
Problem končne jame je s strelsko metodo le trivialna posplošitev
problema neskončne jame: spremeni se le robni pogoj pri $x=a/2$,
ki ima zaradi zahteve po zveznosti in zvezni odvedljivosti valovne
funkcije zdaj obliko $c_1\psi(a/2) + c_2\psi'(a/2) = 0$. 
Alternativno, lahko pri končni jami problem obrnemo in začnemo daleč stran, kjer je funkcija 
(in odvod le-te) skoraj nič, ter poskušamo zadeti  pogoj (soda,liha funkcija) v izhodišču. Preveri,
kaj je bolje (bolj stabilno, natančno)!
Kaj ima pri diferenčni metodi večjo vlogo pri napaki:
končna natančnost diference, s katero aproksimiramo drugi odvod,
ali zrnatost intervala (končna razsežnost matrike, ki jo
diagonaliziramo)?

\subsection{Neskončna potencialna jama}

\subsubsection{Strelska metoda}

Naloge sem se najprej lotil s strelsko metodo. Samo metodo sem implementiral v Rust jeziku, nato pa sem najprej samo malo "streljal" tako da sem našel vrednosti energije, ki zadostijo robnim pogojem. Na ta na;in sem dobil graf \ref{vija}

\begin{figure}[ht]
\begin{center}
    \includegraphics[width=12cm]{graphs/vija.pdf}
    \caption{Graf vrednosti na zadnjem robu pri različnih vrednostih energije. Energije, kjer graf seka x os ustrezajo lastnim energijam}
    \label{vija}
\end{center}
\end{figure}

Ko sem ugotovil, kje se gibljejo lastne energije, sem lahko s pomočjo strelske metode narisal lastne funkcije neskončne potencialne jame. Na ta način sem dobil sliko \ref{lastne}.

Iz grafa seveda takoj prepoznamo še predobro poznane lastne funkcije neskončne potencialne jame, a zanima nas seveda tudi, koliko dejansko odstopajo te funkcije od analitičnih. To seveda ni noben iziv predstaviti na grafu, kot je razvidno na grafu \ref{sherr}

\begin{figure}[H]
\begin{center}
    \includegraphics[width=10cm]{graphs/nekoncna.pdf}
    \caption{Lastne funkcije neskončne potencialne jame, dvignjene za ustrezne lastne energije in nekoliko skalirane za lažje branje}
    \label{lastne}
\end{center}
\end{figure}

\begin{figure}[H]
\begin{center}
    \includegraphics[width=10cm]{graphs/sh_errs.pdf}
    \caption{Odstopanje numerične od analitične rešitve. Opazimo, da je na koncu intervala natančnost omejena na $10^{-5}$ kar ustreza nastavljeni natančnosti naše metode}
    \label{sherr}
\end{center}
\end{figure}


\subsubsection{Diferenčna metoda}

Diferenčna metoda za neskončno jamo je izjemno preprosta, saj efektivno rešujemo zgolj tridiagonalno matriko s samimi 2 na diagonali ter -1 pod in nad diagonalo. Vseeno pa sem se odločil metodo implementirati po zgledu Jonathan Senning - a, čigar koda je na voljo na spletni učilnici. Sam sem pravzaprav metodo zgolj prepisal v Rust.

Z dano metodo sem nato spet preveril lastne funkcije (ki jih nisem grafiral, da se ne ponavljam preveč) in nato na enak način kot poprej, preveril natančnost metode. Rezultati tega so vidni na grafu \ref{fderr}

\begin{figure}[H]
\begin{center}
    \includegraphics[width=10cm]{graphs/fd_errs.pdf}
    \caption{Odstopanje numerične od analitične rešitve. Tudi tukaj smo na drugi rob postavlinekolikšno toleranco, kar se opazi v napaki.}
    \label{fderr}
\end{center}
\end{figure}

\subsubsection{Primerjava metod}

Pri metodah je potrebno primerjati seveda kako natančne so ter  kako hitro to natančnost dosežejo. Tako sem pri različnih "zrnatostih" x osi (velikost matrike n) izvedel obe metodi ter primerjal potreben čas in dobljeno natančnost \ref{grafsss}

\begin{figure}[h]
    \centering
    \begin{minipage}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphs/err.pdf}
        % \caption{Rešitve problema za različne vrednosti parametra $k$ pri začetni temperaturi $21 ^\circ C$}
        % \label{druzina}
    \end{minipage}
    \hfill
    \begin{minipage}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{graphs/time.pdf}
        % \caption{Rešitve problema za različne vrednosti parametra $k$ pri začetni temperaturi $-15 ^\circ C$}
        % \label{druzina 2}
    \end{minipage}
    \label{grafsss}
    \caption{Grafa največjega odstopanja od analitične vrednosti (levo) in potrebnega časa (desno) v odvisnosti od velikosti intervala. Vidimo, da je diferenčna metoda hitrejša, medtem ko je strelska nekoliko natančnejša in že zelo kmalu doseže podano natančnost. Vidimo pa, da je diferenčna metoda nekoliko bolj predvidljiva kar se odstopanja tiče}
\end{figure}

\section{Končna potencialna jama}

Primer končne potencialne jame v teoriji ne bi smel biti dosti težji od neskončne, a seveda se je v praksi to izkazalo za precej bolj zapleteno. Najbolj uspešen sem bil z metodo končnih diferenc, kjer pa sem se problema lotil ako, da sem najprej sestavil matriko in potem poiskal lastne vrednosti in funkcije z diagonalizacijo matrike. Ta metoda je namreč edina ki direktno poišče lastne energije in jih ni potrebno še iskati s kakšno bisekcijo.

V tem primeru se je tudi izkazalo z izjemno pomembno, da sem problem reševal na dovolj veliki matriki, oziroma tudi tam kjer je vrednost lastne funkcije res že praktično 0 (v mojem primeru $\pm 5a$). Dokler je bilo to izpolnjeno, sama matrika ni niti rabila biti preveč zrnata, saj, kot smo vdeli že pri neskončni jame, je metoda zelo natančna tudi pri manjših n-jih.

Tako sem v glavnem dobil lastne funkcije, ki sem jih predstavil na grafu \ref{koncna}. Osredotočil sem se zgolj na vezana stanja.

\begin{figure}[H]
\begin{center}
    \includegraphics[width=10cm]{graphs/koncna.pdf}
    \caption{Lastne funkcije, predstavljene na enak način kot pri \ref{lastne}. Bralec naj bo pozoren na sodost/lihost funkcij}
    \label{koncna}
\end{center}
\end{figure}

Strelska metoda je v tem primeru predstavila mnogo več dela, saj je bilo res težavno zadeti robne pogoje, tako da sem večino časa porabil ob gledanju ravnih črt. Najlažje sem dobil kaj uspeha, tako da sem upošteval robne pogoje na sredini jame (sodost / lihost). V drugem primeru, sem uspel dobiti le prvo lastno funkcijo in še zanjo je bilo računanje izjemno zamudno, tako da me ni bilo potrebno preveč prepričevati v prvo metodo.

\section{Dodatna naloga}

Določi nekaj najnižjih lastnih funkcij $\psi$
in lastnih vrednosti $E=k^4$ diferencialne enačbe
\begin{equation*}
\Dd[4]{\psi}{x} - E\psi = 0
\end{equation*}
(pozor, minus) na intervalu $[-a/2,a/2]$ z robnimi pogoji
\begin{equation*}
\psi(\pm a/2) = \psi''(\pm a/2) = 0
\end{equation*}
z diferenčno metodo oziroma diagonalizacijo.  (Strelska metoda
pri robnih problemih četrtega reda ni najbolj primerna.)
Namesto četrtega odvoda uporabi izraz za četrto diferenco,
tako da ima $i$-ta diferenčna enačba obliko
\begin{equation*}
\psi_{i-2} - 4\psi_{i-1} + 6\psi_i - 4\psi_{i+1} + \psi_{i+2}
= \underbrace{h^4k^4}_\lambda \psi_i \>.  
\end{equation*}
Ko diskretiziraš še robne pogoje, podobno kot pri enačbi
drugega reda rešuješ petdiagonalni sistem linearnih enačb.

\subsection{Diferenčna metoda}

To je edina metoda, ki sem jo uporabil pri reševanju dodatne naloge. Uporabil sem jo tako, da sem konstruiral matriko po navodilih, nato pa sem poiskal lastne vrednosti in vektorje s pomočjo "numpy" vgrajenih funkcij.

Tako sem dobil naslednje lastne funkcije \ref{ekstra}

\begin{figure}[H]
\begin{center}
    \includegraphics[width=10cm]{graphs/exstra.pdf}
    \caption{Lastne funkcije prikazane na dosedaj že dobro poznani način}
    \label{ekstra}
\end{center}
\end{figure}

Globje kot to se v dodatno nalogo nisem poglobil.

\section{Zaključek}

Čeprav sta mi strelska metoda in metoda končnih diferenc zelo všeč še iz lanskoletnega predmeta numeričnih metod, mi njuna raba za iskanje lastnih funkcij ni bila najbolj po godu. 

Kljub temu sem vesel, da sem porabil čas za implementacijo teh metod, saj mi bojo mogoče na kakšni točki prišle prav.

Veliko sivih las mi je tokrat povzročil tudi Rust, ki je tokrat potreboval nekoliko več prepričevanja, preden se je odločil "\ compilati". Ko pa je to odločitev končno sprejel, je s tem prinesel tako veselje, da je bilo skoraj vredno frustracij. Vseeno mislim, da bom moral vsaj nekaj naslednjih nalog narediti v Pythonu, saj ima le ta nekoliko boljši vpliv na moje duševno zdravje.

\end{document}